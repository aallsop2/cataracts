---
title: "Three (Groups of) Blind Mice" 
subtitle: "Familial Clusters of Cataract Development in Irradiated Mice"
author: "Alyssa Allsop and Amira Burns"
date: "`r Sys.Date()`"
output: 
  ioslides_presentation: 
    widescreen: true
    fontsize: 10

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```  



## Introduction
  
- Research Questions:   
    + Is there a genetic susceptibility to cataracts caused by radiation?  
    + Accounting for potential genetic susceptibility, is there a difference in cataract presentation between HZE radiation and gamma radiation? 
- Experimental Design:  
    + 1820 genetically heterogeneous mice from 48 unique families were randomly assigned, with equal family weights, to three treatment groups: Gamma radiation, HZE radiation, and unirradiated control. The simplified dataset records symptoms at time of death for mice of Age $\ge$ 552 days, for a total sample size of 1169.   
    + **Response**: Cataracts score, ordinal categorical variable on a scale 0-5. Score $\ge$ 2 indicates presence of cataracts; because sample sizes in ordinal categories are small, we decided to convert the response into a binary variable indicating absence or presence of cataracts.  
    + **Primary predictors under consideration**: Treatment, Family  
    + **Covariates**: Sex, Weight, Coat Color, Body Condition Score, Age, Myeloid Leukemia, Harderian Tumor, PreT Lymphoma
- Methods Overview:  
    + Mixed Logistic Regression with Treatment as a fixed effect, Family as a random effect, and accounting for any practically significant covariates. Obtain estimates for odds ratios. 
    + Bayesian Mixed Logistic Regression counterpart to Frequentist final model to obtain probability distributions for odds ratios.  

## Summary Tables & Plots


## Mixed Logistic Regression

The final model can be written as:  
\[
\begin{aligned}
Y \sim\ &Binomial(1169, p)\ \ \mbox{or parameterized as   }\  Y_{ij} \sim Bernoulli(p) \\
log(\frac{p}{1-p}) = &\ \beta_0*Control_i*F_i\ +\beta_1*Gamma_i*F_i\ + \beta_2*HZE_i*F_i\ + \\ &\beta_3*Control_i*M_i\ +\beta_4*Gamma*M\ + \beta_5*HZE*M\ + \\
[&v_{j} + \epsilon_{ij}] \\
&i = 1, ..., 1169\ \mbox{ mice} \\
&j = 1,...,47\ \ \mbox{ families}
\end{aligned}
\]  



## Bayesian Mixed Logistic Regression
<div class='"columns-2">

The final Bayesian model can be written as:  
\[
\begin{aligned}
Y \sim Binomial&(1169, p) \ \mbox{   or parameterized as   }\ \ \  Y_{ij} \sim Bernoulli(p)\\
log(\frac{p}{1-p}) = &\ \beta_0*Control_i*F_i\ +\beta_1*Gamma_i*F_i\ + \beta_2*HZE_i*F_i\ + \\ &\beta_3*Control_i*M_i\ +\beta_4*Gamma*M\ + \beta_5*HZE*M\ + \\
&v_{ij} + \epsilon_{ij}\\
&i = 1, ..., 1169\ \mbox{ mice} \\
&j = 1,...,47\ \ \mbox{ families, and} \\
v_j \sim N(0, \tau)
\end{aligned}
\]  


With non-informative parameters:  
\[
\begin{aligned}
\beta_0 &\sim N(0, 0.001)\\
\beta_1 &\sim N(0, 0.001)\\
\beta_2 &\sim N(0, 0.001)\\
\beta_3 &\sim N(0, 0.001)\\
\beta_4 &\sim N(0, 0.001)\\
\beta_5 &\sim N(0, 0.001)\\
\tau &\sim Gamma(0.001, 0.001) \mbox{ where}\ \sigma^2 = 1/\tau\\
\end{aligned}
\]
 
</div>  

```{r postdens}
p0 <- ggplot(posts, aes(x = b0)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[1,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[1,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[1,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Female Control")

p1 <- ggplot(posts, aes(x = b1)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[2,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[2,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[2,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Female Gamma")

p2 <- ggplot(posts, aes(x = b2)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[3,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[3,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[3,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Female HZE")

p3 <- ggplot(posts, aes(x = b3)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[4,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[4,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[4,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Male Contro")

p4 <- ggplot(posts, aes(x = b4)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[5,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[5,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[5,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Male Gamma")

p5 <- ggplot(posts, aes(x = b5)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[6,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[6,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[6,2]), color = "darkorange3") +
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Male HZE")


p6 <- ggplot(posts, aes(x = sigma2)) +
  geom_density(color = "cyan4", fill = "aquamarine4", alpha = 0.5) +
  geom_vline(aes(xintercept = bayes_tab[7,5]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[7,6]), color = "darkorchid", linetype = "dashed") +
  geom_vline(aes(xintercept = bayes_tab[7,3]), color = "darkorange3") + # calculate mode and replot
  scale_x_continuous(expand = c(0, 0)) +
  theme_light() +
  theme(plot.title = element_text(size= 12)) + 
  labs(x = "Probability",
       title = "Random Family Variance")

grid.arrange(p0, p1, p2, p3, p4, p5, p6, 
             ncol = 3, top = "Posterior Densities with 95% HPD Intervals")
```
  
## Results & Conclusions  

- What can we infer about fixed and random effects from the models?
- Limitations?  
- What questions does this raise for future studies?  
  
## References  
  
## Any Questions?  
