library(readxl)
library(tidyverse)
library(kableExtra)
# -- Read in the data
cats <- read_excel("GRSD.cataract.xlsx", sheet = "Sheet1")
head(cats)
str(cats)
length(unique(cats$family))
# family !random effect of interest!
length(unique(cats$fam))
#-- Data wrangling
library(readxl)
library(tidyverse)
library(kableExtra)
# -- Read in the data
cats <- read_excel("GRSD.cataract.xlsx", sheet = "Sheet1")
head(cats)
str(cats)
# remove spaces from column and value names
names(cats) <- str_replace_all(names(cats), " ", "_")
cats <- cats %>%
mutate(coat_color = str_replace_all(coat_color, " ", "_"))
str(cats)
# turn categorical vars into factor
cats <- cats %>%
rename(age = `age_(days)`) %>%
mutate(sex = as.factor(sex),
coat_color = as.factor(coat_color),
fam = as.factor(family), # should this stay a factor? Yes?
BCS = as.factor(BCS),
group = as.factor(group),
groups = as.factor(groups),
myeloid_leuk = as.factor(Myeloid_Leukemia),
harderian_tumor = as.factor(Harderian_Tumor),
preT_lymph = as.factor(PreT_Lymphoma),
cat_score = as.ordered(Cataract_Score)) # ordinal cat; leave as numeric?
# individual
length(unique(cats$animal))
# sex
cats %>% count(sex)
# weight
summary(cats$weight)
hist(cats$weight, br = 20)
# coat color - probably irrelevant?
cats %>% count(coat_color)
cats %>% group_by(coat_color) %>% count(sex)
cats %>% group_by(family) %>% count(coat_color)
# family !random effect of interest!
length(unique(cats$fam))
fam_counts <- cats %>% group_by(fam) %>% count()
summary(fam_counts$n)
hist(fam_counts$n, br = 15) # large variation in family size; watch for this!
#-- Review Response
cats %>% count(cat_score)
unique(cats$cat_score)
range(cats$weight)
unique(cats$coat_color)
levels(cats$family)
length(unique(cats$family))
cats$BCS <- as.ordered(cats$BCS)
cats$BCS
range(cats$age)
var(cats$cat_score)
var(cats$age)
# score by group, family - too long
fam_scores <- cats %>% group_by(family, groups) %>%
summarise(mean_score = mean(as.numeric(cat_score))) %>%
pivot_wider(names_from = groups, values_from = mean_score) %>%
kbl(caption = "Mean Cataract Score by Group within Family", digits = 2) %>%
kable_classic(full_width = F, html_font = "Cambria")
fam_scores
cats %>% group_by(groups) %>% count()
cats %>% group_by(cat_score) %>% count(groups)
cats %>% group_by(cat_score) %>%
summarise(n = n(groups))
cats %>% group_by(cat_score) %>%
summarise(n = count(groups))
cats %>% group_by(cat_score, groups) %>%
summarise(n = n())
cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n)
group_score_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = sum(`1`, `2`, `3`, `4`)) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = rowsum()) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
rowSums() %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = rowSums()) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = rowSums(.)) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = rowSums(.x)) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = rowSums(grs_ct)) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria")
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", size = 10)
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 10)
grs_xt
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group", font_size = 11) %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 11)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 16)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cat Score" = 4, " " = 1)) %>%
kable_classic(html_font = "Cambria", font_size = 12)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cataract Score" = 4, " " = 1)) %>%
kable_classic(html_font = "Cambria", font_size = 12)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cataract Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 20)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cataract Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 24)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Cataract Score by Treatment Group") %>%
add_header_above(c( " " = 1, "Cataract Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 14)
grs_ct
grs_ct <- cats %>% group_by(cat_score) %>%
count(groups) %>%
pivot_wider(names_from = cat_score, values_from = n) %>%
group_by(groups) %>%
mutate(total = sum(c(`1`, `2`, `3`, `4`))) %>%
kbl(caption = "Counts of Score by Treatment") %>%
add_header_above(c( " " = 1, "Cataract Score" = 4, " " = 1)) %>%
kable_classic(full_width = F, html_font = "Cambria", font_size = 14)
grs_ct
# Score by age and treatment group
ggplot(cats, aes(x = cat_score, y = age, color = groups)) + geom_jitter(width = 0.2)
ggplot(cats, aes(x = cat_score, y = age, fill = groups)) + geom_boxplot() + facet_wrap(vars(groups))
ggplot(cats, aes(x = groups, y = age, fill = cat_score)) + geom_boxplot() + facet_wrap(vars(cat_score))
# Score by treatment group
# distribution looks similar across groups
ggplot(cats, aes(x = as.numeric(cat_score))) + geom_histogram(bins = 4) + facet_grid(vars(groups))
# Score by age and treatment group
ggplot(cats, aes(x = cat_score, y = age, color = groups)) + geom_jitter(width = 0.2)
ggplot(cats, aes(x = groups, y = cat_score)) + geom_jitter(width = 0.2)
# plot of score by group faceted by family
ggplot(aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family))
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family))
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family)) +
theme_minimal()
library(ggsci)
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family)) +
scale_color_startrek() +
scale_x_discrete(labels = c("Gam", "HZE", "none")) +
theme(axis.text.x = element_text(angle = 45)) +
labs(x = "Treatment Group", y = "Cataract Score", color = "Group",
main = "Cataract Score by Treatment, faceted by Family")
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family)) +
scale_color_startrek() +
scale_x_discrete(labels = c("Gam", "HZE", "none")) +
theme(axis.text.x = element_text(angle = 45)) +
labs(x = "Treatment Group", y = "Cataract Score", color = "Group",
title = "Cataract Score by Treatment, faceted by Family")
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family)) +
scale_color_startrek() +
scale_x_discrete(labels = c("Gam", "HZE", "none")) +
theme_light(axis.text.x = element_text(angle = 45)) +
labs(x = "Treatment Group", y = "Cataract Score", color = "Group",
title = "Cataract Score by Treatment, faceted by Family")
# plot of score by group faceted by family
ggplot(cats, aes(x = groups, y = cat_score, color = groups)) + geom_jitter(width = 0.2) +
facet_wrap(vars(family)) +
scale_color_startrek() +
scale_x_discrete(labels = c("Gam", "HZE", "none")) +
theme_light() +
theme(axis.text.x = element_text(angle = 45)) +
labs(x = "Treatment Group", y = "Cataract Score", color = "Group",
title = "Cataract Score by Treatment, faceted by Family")
